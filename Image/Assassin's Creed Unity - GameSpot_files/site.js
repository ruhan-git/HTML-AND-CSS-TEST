$(document).ready(function(){"use strict";var $window=$(window);var livefyreChangeHandler=function(){$("#livefyre").removeClass("hide");$window.trigger("livefyreChange")};var parameters=$.parseJSON($(document).find('meta[itemprop="jsParameters"]').attr("content")),globalConfig,streamConfig=[],authDelegate={login:function(handlers){window.location=parameters.login_url+"?redirect_url="+document.URL},logout:function(handlers){window.location=parameters.logout_url},viewProfile:function(handlers,author){if(author.profileUrl){location.href=author.profileUrl}},editProfile:function(handlers,user){location.href="/profile/settings/"}},lf_events={initialRenderComplete:livefyreChangeHandler,commentPosted:function(data,par){_gaq.push(["_trackEvent","Comments","comment",data.authorId]);DW.levt("ria","log",{mapp:"livefyre",riaevent:"post",objtyp:"comments",objnm:data.targetId,s6:0,s7:DW.pageParams.ursuid,i1:8,i2:DW.pageParams.asid,i3:9,i4:DW.pageParams.contid});if(data.parent!==null){DW.levt("ria","log",{mapp:"livefyre",riaevent:"reply",objtyp:"comments",objnm:data.targetId,s6:0,s7:DW.pageParams.ursuid,i1:8,i2:DW.pageParams.asid,i3:9,i4:DW.pageParams.contid})}$.ajax({url:"/livefyre/comment-posted/",data:{articleId:streamConfig[0].articleId,guid:$("#livefyre").data("guid")}})},commentFlagged:$.noop,commentLiked:function(data){DW.levt("ria","log",{mapp:"livefyre",riaevent:"like",objtyp:"comments",objnm:data.targetId,s7:DW.pageParams.ursuid,i1:8,i2:DW.pageParams.asid,i3:9,i4:DW.pageParams.contid})},commentShared:function(data){DW.levt("ria","log",{mapp:"livefyre",riaevent:"share",objtyp:"comments",objnm:data.targetId,s7:DW.pageParams.ursuid,i1:8,i2:DW.pageParams.asid,i3:9,i4:DW.pageParams.contid})},commentCountUpdated:$.noop,userLoggedIn:$.noop,userLoggedOut:$.noop};var delay=false;$('[data-component="livefyreConversation"]').each(function(){var options=$(this).data("livefyreConversationOptions");options.commentStreamConfigs.authPageReload=true;globalConfig=options.globalConfig;streamConfig.push(options.commentStreamConfigs);if(!delay){delay=typeof $(this).parent().attr("data-delayLivefyre")!=="undefined"}});var loadLivefyre=function(){$.getScript(parameters.livefyre_script_url,function(){globalConfig.authDelegate=$.extend(new fyre.conv.RemoteAuthDelegate,authDelegate);fyre.conv.load(globalConfig,streamConfig,function(widget){var $tokenMeta=$("[itemprop=livefyreToken]"),response=null;if($tokenMeta&&$tokenMeta.length>0){try{response=$.parseJSON($tokenMeta.attr("content"))}catch(e){response=null}if(response&&response.userToken){fyre.conv.login(response.userToken)}}$.each(lf_events,function(event,handler){widget.on(event,function(data){handler(data)})});$(".js-loadLivefyre").remove()})})};if(typeof globalConfig!=="undefined"){if(delay){$(".js-loadLivefyre").click(function(){event.preventDefault();$(this).html("Loading Comments...");loadLivefyre()})}else{loadLivefyre()}}var popoutwindow=null;$(".js-livefyrePopout").click(function(event){event.preventDefault();var height=$window.height();popoutwindow=window.open($(this).attr("href"),"LivefyreChatPopout","width=500,height="+height+",location=no,menubar=no,scroll=yes")})});
$(function(){var postRenderriverUpvotes=function(){var $riverUpvotes=$(".js-river-upvote");if(!$riverUpvotes||$riverUpvotes.length<1){return false}PostRender.getPostRenderData("UserBundle",function(commonData,UserBundleData){if($.isEmptyObject(UserBundleData)){return}var riverUpvoteData=UserBundleData.riverUpvote;$.each(riverUpvoteData,function(key,value){if(value>0){var $upvote=$riverUpvotes.filter('[data-post-render-value="'+key+'"]'),$upvoteCount=$upvote.find(".js-upvote-count-value");$upvoteCount.text(value);$upvote.removeClass("hide")}})});return true};postRenderriverUpvotes()});
(function(){"use strict";var $doc=$(document),KEY_CODE_UP=38,KEY_CODE_DOWN=40,KEY_CODE_LEFT=37,KEY_CODE_RIGHT=39,KEY_CODE_A=65,KEY_CODE_B=66,KEY_CODE_ENTER=13,pattern=[KEY_CODE_UP,KEY_CODE_UP,KEY_CODE_DOWN,KEY_CODE_DOWN,KEY_CODE_LEFT,KEY_CODE_RIGHT,KEY_CODE_LEFT,KEY_CODE_RIGHT,KEY_CODE_B,KEY_CODE_A,KEY_CODE_ENTER],position=0;$doc.ready(function(){var $kCodeElement=$("#kCode"),targetUrl;if(!$kCodeElement||$kCodeElement.length<1){return}targetUrl=$kCodeElement.attr("content");if(targetUrl&&targetUrl.indexOf("/")===0){$doc.on("keydown",function(e){if(e.keyCode===pattern[position]){position++;if(position===pattern.length){window.location.href=targetUrl}}else{position=0}})}})})();