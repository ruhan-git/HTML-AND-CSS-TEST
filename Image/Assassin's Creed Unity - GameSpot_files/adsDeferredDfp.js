(function(context){"use strict";var scriptId="ad-service-client";var viewGuidId="view-guid-meta";var viewGuidAttribute="content";var viewGuidTargetingKey="vguid";var adCompanionId="companion_ad",adLeaderPlusTopId="leader_plus_top",adLeaderTopId="leader_top",adOmnibarTopId="omnibar_top",adNavLogoTopId="nav_logo_top",adSkinTopId="skin_top",adMpuTopId="mpu_top",adYtembedTopId="ytembed_top";var showAdSkinClass="skin-yes",hideAdSkinClass="skin-no",noAdsClass="no-ads",hasAdsClass="has-ads",hasNavLogoAdClass="has-nav-sponsor",hasOmnibarAdClass="has-omnibar",blankAdClassName="mapped-ad-blank",defaultSkinTypeClass="skinadaptive";var adDivWrapperSuffix="-wrap";var adEventAttribute="data-ad-event";var deferred=true,gt,gtCmdQueue=[],displayAdCmd,adService,logger=context.siteAdsLogger||[],doc=context.document,docReady=false,docBody,scriptLoaded=false,pageLoadEventName="pageLoad",currentSkinType,currentPageEvent=pageLoadEventName,definedAds={};var hasAdServiceClient=function(){var adServiceClientEl;adServiceClientEl=docId(scriptId);if(adServiceClientEl){return true}return false};var getAdWrapper=function(divId){return docId(divId+adDivWrapperSuffix)};var skinLeaderCheck=function(){var leaderId,leaderDiv,leaderDivWrap,skinId=adSkinTopId,skinDiv=docId(skinId),skinDivWrap=getAdWrapper(skinId),skinPrevSibling,skinNextSibling,checkVal=false;if(!!skinDivWrap){skinPrevSibling=skinDivWrap.previousElementSibling;skinNextSibling=skinDivWrap.nextElementSibling}leaderId=adLeaderTopId;leaderDiv=docId(leaderId);if(!leaderDiv){leaderId=adLeaderPlusTopId;leaderDiv=docId(leaderId)}leaderDivWrap=getAdWrapper(leaderId);if(!!skinDivWrap&&!!leaderDivWrap&&(skinNextSibling===leaderDivWrap||skinPrevSibling===leaderDivWrap)){checkVal=true}return{skinDiv:skinDiv,skinDivWrap:skinDivWrap,skinNextSibling:skinNextSibling,leaderDiv:leaderDiv,leaderDivWrap:leaderDivWrap,isAdjacent:checkVal}};var processSkin=function(){var _processed=false;return function(){if(true===_processed){return}var ads=getDefinedAds();if(true===ads.rendered[adSkinTopId]){var skinLeaderData=skinLeaderCheck(),leaderDivWrap=skinLeaderData.leaderDivWrap,skinDivWrap=skinLeaderData.skinDivWrap,skinNextSibling=skinLeaderData.skinNextSibling,skinParent;logger.push("Processing skin render");if(!!skinDivWrap){skinParent=skinDivWrap.parentElement}if(!!skinParent&&!!leaderDivWrap&&false===skinLeaderData.isAdjacent){logger.push("Move leader after skin");clearAdDiv(skinLeaderData.leaderDiv);skinParent.insertBefore(leaderDivWrap,skinNextSibling)}_processed=true}if(!!ads.adSkinId&&ads.loaded.length===1){logger.push("Skin loaded, refresh remaining ads");refreshAds()}}}();var processMpu=function(){var _processed=false,mpuId=adMpuTopId;return function(){var ads=getDefinedAds();if(true===_processed){return}var adDiv=getAdWrapper(mpuId),divParent=adDiv.parentElement,baseParent,parentNoAdClass,parentHasAdClass;if(true===ads.rendered[mpuId]){var mpuClass="js-livestream-mpu",mpuCloseClass="js-livestream-mpu-close",hideMpuClass="hide-mpu";if(!!divParent&&!!divParent.tagName&&!!divParent.classList.contains(mpuClass)&&!!context.$){setTimeout(function(){context.$("."+mpuCloseClass).on("click",function(){context.$(this).parent().fadeOut(function(){context.$(this).remove();context.$("body").addClass(hideMpuClass)})}).css("visibility","visible").hide().fadeIn()},1e4)}}else{divParent=adDiv.parentElement;if(!!divParent&&!!divParent.tagName&&"li"===divParent.tagName.toLowerCase()){baseParent=divParent.parentElement}if(!!baseParent&&!!baseParent.getAttribute){parentNoAdClass=baseParent.getAttribute("data-no-ads-class");parentHasAdClass=baseParent.getAttribute("data-has-ads-class");toggleClass(baseParent,parentHasAdClass,false);toggleClass(baseParent,parentNoAdClass,true);baseParent.removeChild(divParent)}_processed=true}}}();var processYtembed=function(){var hasYtembedClass="has-ytembed has-ytembed-rendered",noYtembedClass="no-ytembed",ytembedWrapperSelector=".ytembed-wrapper",$ytembedWrapper;return function(){var ads=getDefinedAds(),rendered=ads.rendered[adYtembedTopId],$adDiv=$(getAdWrapper(adYtembedTopId)),hasAdClass,noAdClass;if(undefined===$ytembedWrapper){$ytembedWrapper=$adDiv.parents(ytembedWrapperSelector)}if(!$ytembedWrapper||0===$ytembedWrapper.length){return}hasAdClass=$ytembedWrapper.data("ytembed-class")||hasYtembedClass;noAdClass=$ytembedWrapper.data("ytembed-blank-class")||noYtembedClass;if(!rendered){$ytembedWrapper.removeClass(hasAdClass);$ytembedWrapper.addClass(noAdClass)}else{$ytembedWrapper.addClass(hasAdClass);$ytembedWrapper.removeClass(noAdClass)}}}();var processRenderedAd=function(adData){var adId=adData.divId,processCallback;switch(adId){case adMpuTopId:processCallback=processMpu;break;case adYtembedTopId:processCallback=processYtembed;break}if(processCallback){logger.push("Ad render processed for ["+adId+"]");processCallback()}};var adIsSkin=function(adId){return adId.indexOf("skin")>=0};var toggleAd=function(id,hide){var wrap=getAdWrapper(id);if(!!wrap){toggleClass(wrap,blankAdClassName,hide)}};var toggleAdSkin=function(hide,skinType){var dBody=getDocBody(),oldSkinType,newSkinType;if(!!hide){logger.push("skinless");toggleClass(dBody,hideAdSkinClass,true);toggleClass(dBody,showAdSkinClass,false);if(!!currentSkinType){oldSkinType=currentSkinType}}else{toggleClass(dBody,showAdSkinClass,true);toggleClass(dBody,hideAdSkinClass,false);if(!skinType||"null"===skinType){skinType=defaultSkinTypeClass}if(skinType!==currentSkinType){oldSkinType=currentSkinType;currentSkinType=newSkinType=skinType}logger.push("skinned: "+skinType)}if(!!oldSkinType){toggleClass(dBody,oldSkinType,false)}if(!!newSkinType){logger.push("Setting skin type to "+newSkinType);toggleClass(dBody,newSkinType,true)}processSkin()};var pageEventAdSettingsClass="page-event-ad-settings",getPageEventAdSettings=function(){var $=context.jQuery,pageEventAdSettings=[];if(!!$){$("."+pageEventAdSettingsClass).each(function(){var $el=$(this),data=null;if($el.length>0){try{data=$.parseJSON($el.attr("content"))}catch(e){data=null}}if(null!==data){pageEventAdSettings.push(data)}})}return pageEventAdSettings};var hasNewTargeting=false;var verifyPageEvent=function(e,eventName,changed){if(!eventName||!changed){return}currentPageEvent=eventName;hasNewTargeting=true};var initPageEventListeners=function(){var initialized=false;return function(){if(initialized){return}initialized=true;var $=context.jQuery;if(!!$){$(doc).on({update_page_event:function(e,eventName){verifyPageEvent(e,eventName,currentPageEvent!==eventName)},render_page_event:verifyPageEvent,on_page_event:function(e,eventName){if(!eventName){return}refreshAds(eventName)},remove_page_event:function(e,eventName){if(!eventName){return}destroyAds(eventName);currentPageEvent=defaultPageEvent}})}}}();var docId=function(id){return doc.getElementById(id)};var getDocBody=function(){if(!docBody){docBody=doc.body}return docBody};var parseJSON=function(s){try{return context.JSON.parse(s)}catch(e){return null}};var stringifyJSON=function(value,replacer,space){try{return context.JSON.stringify(value,replacer,space)}catch(e){return null}};var toggleClass=function(el,className,on){var elClassName=el.className,paddedClassName=" "+className,newClassName,startPos=0,endPos=0;if(on===true&&hasClass(el,className)===false){if(elClassName.length>0){newClassName=elClassName+paddedClassName}else{newClassName=className}}else if(on===false&&hasClass(el,className)===true){if(elClassName.length>0){startPos=elClassName.indexOf(paddedClassName);if(startPos===-1){startPos=elClassName.indexOf(className)}endPos=startPos+className.length+1;newClassName=elClassName.substr(0,startPos)+elClassName.substr(endPos)}}if(newClassName!==undefined){el.className=newClassName}};var hasClass=function(el,className){var elClassName=el.className,response=false;if(!!elClassName){response=elClassName.indexOf(className)>=0}return response};var pageSettings=[],defaultPageEvent=pageLoadEventName;var getViewGuid=function(){var el=docId(viewGuidId),key=viewGuidAttribute,guid;try{if(!!el&&el.hasAttribute(key)){guid=el.getAttribute(key)}}catch(e){}return guid};var getCampaignParams=function(){var campaignParamKeys=["ftag","vndid"];return function(targetParams){var Phoenix=context.Phoenix,campaignParams=Phoenix&&Phoenix.CampaignParams&&Phoenix.CampaignParams.getParams&&Phoenix.CampaignParams.getParams()||null,paramKey,i;if(campaignParams){logger.push("[AD SETTINGS][CAMPAIGN PARAMS] ",campaignParams)}if(targetParams&&campaignParams){for(i=0;i<campaignParamKeys.length;i++){paramKey=campaignParamKeys[i];if(campaignParams[paramKey]){targetParams[paramKey]=campaignParams[paramKey]}}return targetParams}return campaignParams}}();var getSettingsEl=function(prefix){var selector="ad-settings";if(!!prefix&&prefix!==defaultPageEvent){selector=prefix+"-"+selector}return docId(selector)};var getSettings=function(settingsKey){var settingsAttr="content",settings,el;settingsKey=settingsKey||currentPageEvent||defaultPageEvent;settings=pageSettings[settingsKey];if(settings===undefined){el=getSettingsEl(settingsKey);if(!el){settings=null}else{if(el.hasAttribute(settingsAttr)){settingsAttr=el.getAttribute(settingsAttr);settings=parseJSON(settingsAttr);if(settings&&settings.target_params){settings.target_params.session=$.cookie("AD_SESSION");getCampaignParams(settings.target_params)}}else{settings=null}}pageSettings[settingsKey]=settings;logger.push("[AD SETTINGS]["+settingsKey+"]: ",settings)}return settings};var addPageEventSettings=function(settingsKey,settings){if(!!settingsKey&&!!settings){pageSettings[settingsKey]=settings}};var renderAdCallback=function(adData,renderDetected){var ads=getDefinedAds(),adId=adData.divId,isBlank=adData.isBlank,isSkin=adData.isSkin,skinType=adData.skinType,dBody=getDocBody(),dBodyAdSpecificClass=false,msgPrefix="";cancelAdBlockCheck();if(true===renderDetected){msgPrefix="Ad render detected > "}else{msgPrefix="Callback from creative > "}logger.push(msgPrefix+"renderAdCallback: "+stringifyJSON(adData));if(!adId&&true===isSkin){adId=adSkinTopId}ads.rendered[adId]=!isBlank;ads.loaded.push(adId);if(!!isBlank){toggleAd(adId,true);if(!!isSkin){toggleAdSkin(true)}}else{toggleAd(adId,false);if(!!isSkin){toggleAdSkin(false,skinType)}switch(adId){case adNavLogoTopId:logger.push("Nav logo ad exists");dBodyAdSpecificClass=hasNavLogoAdClass;break;case adOmnibarTopId:logger.push("Omnibar ad exists");dBodyAdSpecificClass=hasOmnibarAdClass;break}if(dBodyAdSpecificClass){toggleClass(dBody,dBodyAdSpecificClass,true)}toggleClass(dBody,hasAdsClass,true)}toggleClass(dBody,noAdsClass,false);processRenderedAd(adData);if(!!$){$(doc).trigger("ad_rendered",adData)}if(false===ads.refreshAllowed&&ads.mapped.length===ads.loaded.length){logger.push("ALL ADS LOADED");toggleAdRefreshable(true)}};context.renderAdCallback=renderAdCallback;var setTargeting=function(subject,targeting){var targetKey,targetLogStr;if(!subject||!subject.setTargeting||!targeting){return}for(targetKey in targeting){if(targeting.hasOwnProperty(targetKey)){targetLogStr='("'+targetKey+'", "'+targeting[targetKey]+'")';try{subject.setTargeting(targetKey,targeting[targetKey].toString());logger.push("-> setTargeting"+targetLogStr)}catch(e){logger.push("error","setTargeting failed for "+targetLogStr+". Please make sure targeting key and value are strings.")}}}};var initAdSlot=function(unitName,slotId,slotData){var slot,targeting,adEvent,adDiv,adData={adId:slotId};if(deferred){adDiv=docId(slotId);if(!adDiv){return false}adData.adDiv=adDiv;if(adDiv.hasAttribute(adEventAttribute)){adEvent=adDiv.getAttribute(adEventAttribute)}}if(!adEvent){adEvent=pageLoadEventName}adData.adEvent=adEvent;if(!!slotData.outOfPage){logger.push("DEFINE out of page slot ["+slotId+"]");slot=gt.defineOutOfPageSlot(unitName,slotId).addService(adService)}else{logger.push("DEFINE slot ["+slotId+"] with sizes "+stringifyJSON(slotData.size));slot=gt.defineSlot(unitName,slotData.size,slotId);if(adCompanionId===slotId){logger.push("-> Adding companionAds service");slot.addService(gt.companionAds())}slot.addService(adService);targeting=slotData.target;if(!!targeting){logger.push("-> Set slot ["+slotId+"] targeting:");setTargeting(slot,targeting)}}adData.adSlot=slot;adService.addEventListener("slotRenderEnded",function(event){if(event.slot===slot){logger.push("SLOT RENDER ENDED for slotId ["+slotId+"]: ",event);if(!adIsSkin(slotId)){var isBlank="none"===adDiv.style.display;renderAdCallback({divId:slotId,isBlank:isBlank||event.isEmpty},true)}}});addDefinedAd(adData);return true};var initAdSlots=function(settingsKey){var s=getSettings(settingsKey),defaultSettings=getSettings(),unitName=s.unit_name||defaultSettings.unit_name,pageEventName=s.page_event_name,slotId,mappedSlots,logMsgPrefix="Defining ads for ",hasAdSlots=false,ignoredSlots=[],hasAdSlot;if(!!pageEventName){logMsgPrefix+="["+pageEventName+"] page event with "}mappedSlots=s.mapped_units;if(!!mappedSlots){logger.push(logMsgPrefix+"unitName: ["+unitName+"]");for(slotId in mappedSlots){if(mappedSlots.hasOwnProperty(slotId)){hasAdSlot=initAdSlot(unitName,slotId,mappedSlots[slotId],pageEventName);hasAdSlots=hasAdSlot||hasAdSlots;if(false===hasAdSlot){ignoredSlots.push(slotId)}}}if(ignoredSlots.length>0){logger.push("IGNORED slots with missing adDivs: ["+ignoredSlots.join(", ")+"]")}return hasAdSlots}return false};var hasPageEventAdUnits=function(){var initialized=false,hasAdDefinitions=false;var initPageEventAdUnits=function(){var pageEventAdSettings=getPageEventAdSettings(),settings,settingsKey,i;if(!!pageEventAdSettings&&0<pageEventAdSettings.length){for(i=0;i<pageEventAdSettings.length;i++){settings=pageEventAdSettings[i];settingsKey=settings.page_event_name;if(!!settingsKey){addPageEventSettings(settingsKey,settings);hasAdDefinitions=initAdSlots(settingsKey)||hasAdDefinitions}}}return hasAdDefinitions};return function(){if(true===initialized){return hasAdDefinitions}initialized=true;return initPageEventAdUnits()}}();var requiresPageEventListeners=function(){var requiresListeners;return function(){if(undefined===requiresListeners){if(hasPageEventAdUnits()||getDocBody().className.indexOf("has-page-events")>=0){requiresListeners=true}else{requiresListeners=false}}return requiresListeners}}();var initPage=function(settingsKey){var s=getSettings(settingsKey),targeting=s.target_params,guid=getViewGuid();if(!!targeting){if(!!guid){targeting.vguid=guid}logger.push("SET PAGE LEVEL TARGETING:");setTargeting(adService,targeting)}else{logger.push("There are no page targeting key/value pairs")}};var initService=function(){var s=getSettings(),disableInitialLoad=!!s.disable_initial_load,hasAdDefinitions=false;logger.push("performance","logInitService");adService=gt.pubads();hasAdDefinitions=initAdSlots()||hasAdDefinitions;if(true===deferred){hasAdDefinitions=hasPageEventAdUnits()||hasAdDefinitions}if(true===requiresPageEventListeners()){initPageEventListeners()}if(false===hasAdDefinitions){logger.push("No ads on the page. Quitting.");return}initPage();if(s.enable_collapse_empty_divs){logger.push("Enable collapse empty divs");adService.collapseEmptyDivs(true)}if(true===s.single_request){logger.push("Enable single request");adService.enableSingleRequest()}if(false===deferred){logger.push("Enable sync rendering");adService.enableSyncRendering()}if(true===disableInitialLoad){logger.push("Disable initial load");adService.disableInitialLoad()}logger.push("Enable services");logger.push("performance","logEnableServices");gt.enableServices();$(document).trigger("ads_initialized");if(true===deferred&&true===disableInitialLoad){logger.push("Refresh Ads");refreshAds()}initDisplayAds();logger.push("performance","results")};var addDefinedAd=function(adData){var adId=adData.adId,adEvent=adData.adEvent,skinLeaderData;if(!definedAds[adEvent]){definedAds[adEvent]={adSkinId:null,adIds:[],map:{},rendered:{},mapped:[],requested:[],loaded:[],guilty:false,refreshAllowed:true,refreshRequested:false}}delete adData.adId;definedAds[adEvent].map[adId]=adData;definedAds[adEvent].mapped.push(adId);if(!!deferred&&adIsSkin(adId)){skinLeaderData=skinLeaderCheck();if(true===skinLeaderData.isAdjacent){definedAds[adEvent].adIds.push(adId)}else{definedAds[adEvent].adSkinId=adId}}else{definedAds[adEvent].adIds.push(adId)}};var getDefinedAds=function(adEvent){if(!adEvent){adEvent=currentPageEvent}return definedAds[adEvent]};var getDefinedAdIds=function(adEvent){var ads=getDefinedAds(adEvent),skinId,adIds;if($.isEmptyObject(ads)){return}skinId=ads.adSkinId;if(!!skinId&&undefined===ads.rendered[skinId]){adIds=[skinId]}if(!adIds){adIds=ads.adIds.slice(0)}return adIds};var getDefinedAdDivs=function(adEvent){var ads=getDefinedAds(adEvent),adIds=getDefinedAdIds(adEvent),adDivs=[],i;for(i=0;i<adIds.length;i++){adDivs.push(ads.map[adIds[i]].adDiv)}return adDivs};var getDefinedAdSlots=function(adEvent){var ads=getDefinedAds(adEvent),adIds=getDefinedAdIds(adEvent),adSlots=[],i;for(i=0;i<adIds.length;i++){adSlots.push(ads.map[adIds[i]].adSlot)}return adSlots};var adBlockCheckTimeoutId;var cancelAdBlockCheck=function(){window.clearTimeout(adBlockCheckTimeoutId);adBlockCheckTimeoutId=null};var checkForAdBlock=function(){var adTimeoutDuration=5e3;var checkForBlockedAds=function(){var ads=getDefinedAds(),adIds=getDefinedAdIds();if($.isEmptyObject(ads)){return}var diff=$(adIds).not(ads.loaded).get();var settings=getSettings(),mappedUnits=settings.mapped_units,$adWrapper,$clonedAd,guiltSrc,adStyle,adUnit,adId,divId,isBlank,isGuilt,adData;logger.push("GUILT CHECK ["+diff.join(", ")+"]");if(mappedUnits){for(var i=0;i<diff.length;i++){adId=diff[i];adUnit=mappedUnits[adId];guiltSrc=adUnit.guilt;ads.guilty=true;ads.rendered[adId]=true;ads.loaded.push(adId);$adWrapper=$(getAdWrapper(adId));if(undefined!==guiltSrc){$clonedAd=$adWrapper.clone();divId="guilt_"+adId;isBlank=false;isGuilt=true;adStyle=$adWrapper.getStyleObject();adStyle.display="block";$clonedAd.attr({id:divId,"class":null});$clonedAd.css(adStyle);$clonedAd.html('<img src="'+guiltSrc+'" alt="Please disable adblock" />');$adWrapper.replaceWith($clonedAd)}else{divId=adId;isBlank=true;isGuilt=false;$adWrapper.removeClass();toggleAd(adId,true)}adData={divId:divId,isBlank:isBlank,isBlocked:true,isGuilt:isGuilt};logger.push("GUILT RENDERED for ["+adId+"]");$(doc).trigger("ad_rendered",adData)}if(!!ads.adSkinId&&ads.loaded.length===1){adTimeoutDuration=0;refreshAds()}}};return function(){cancelAdBlockCheck();adBlockCheckTimeoutId=window.setTimeout(checkForBlockedAds,adTimeoutDuration)}}();var guiltCheck=function(){var s=getSettings(),enableGuilt=false;if(s){enableGuilt=s.enable_guilt}if(true===enableGuilt){checkForAdBlock()}};var resetRenderedDisplayAds=function(adEvent){var ads=getDefinedAds(adEvent),adSkinId=ads.adSkinId,loadedCount=ads.loaded.length,reset=false;if(!!adSkinId){if(loadedCount>1){reset=true}}else if(loadedCount>0){reset=true}if(true===reset){ads.rendered={};ads.loaded=[];ads.requested=[]}};var displayAd=function(adId){logger.push("DISPLAY ["+adId+"] ad");gt.cmd.push(function(){gt.display(adId)})};var clearAdDiv=function(adDiv){if(!!adDiv){toggleAd(adDiv.id,false);if(0<adDiv.innerHTML.indexOf("iframe")){logger.push("RESET adDiv ["+adDiv.id+"]");adDiv.style.display="";adDiv.innerHTML=""}}};var destroyAds=function(adEvent){var adDivs=getDefinedAdDivs(adEvent),adDiv,i;resetRenderedDisplayAds(adEvent);if(!adDivs||adDivs.length<1){return}for(i=0;i<adDivs.length;i++){adDiv=adDivs[i];clearAdDiv(adDiv)}};var updateAdTargeting=function(){var guid=getViewGuid(),newTargeting={};newTargeting[viewGuidTargetingKey]=guid;logger.push("UPDATE PAGE LEVEL TARGETING:");setTargeting(adService,newTargeting)};var toggleAdRefreshable=function(enable){var ads=getDefinedAds();if(true===enable&&ads.refreshAllowed!==enable){logger.push("RE-ENABLE REFRESH in 5 seconds");setTimeout(function(){logger.push("RE-ENABLE REFRESH");ads.refreshAllowed=true;if(true===ads.refreshRequested){ads.refreshRequested=false}},5e3)}else{ads.refreshAllowed=enable}};var refreshAds=function(adEvent){var ads=getDefinedAds(adEvent),refreshAllowed=ads.refreshAllowed;if(true===ads.refreshRequested){refreshAllowed=false}else if(ads.requested.length>ads.loaded.length){refreshAllowed=false}if(false===refreshAllowed){if(false===ads.guilty&&false===ads.refreshRequested){logger.push("REFRESH request flagged for later");ads.refreshRequested=true}return}gt.cmd.push(function(){var adIds=getDefinedAdIds(adEvent),adSlots=getDefinedAdSlots(adEvent);destroyAds(adEvent);if(hasNewTargeting){updateAdTargeting()}if(1>ads.requested.length){ads.requested=adIds}else{ads.requested=ads.requested.concat(adIds)}if(ads.mapped.length===ads.requested.length){logger.push("DISABLE REFRESH until all ads have been rendered");toggleAdRefreshable(false)}logger.push("REFRESH ad slots: ["+adIds.join(", ")+"]");adService.refresh(adSlots)});guiltCheck()};window.refreshAds=refreshAds;var getDisplayAdCmd=function(){displayAdCmd=context.displayAdCmd||[];context.displayAdCmd=displayAdCmd};var initDisplayAds=function(){getDisplayAdCmd();if(displayAdCmd.length>0){for(var i=0;i<displayAdCmd.length;i++){displayAd(displayAdCmd[i])}}displayAdCmd={};displayAdCmd.push=function(adData){displayAd(adData)};context.displayAdCmd=displayAdCmd};var init=function(){PostRender.getPostRenderData("TrackingBundle",function(commonData,bundleData){$(".js-post-render-ad-tracking-consumer").each(function(i,e){var $this=$(e);var dataStr=$this.attr("content");for(var field in bundleData){if(bundleData.hasOwnProperty(field)){dataStr=dataStr.replace(new RegExp("{"+field+"}","g"),bundleData[field])}}$this.attr("content",dataStr)});var s=getSettings();if(!s){return}if(bundleData.abTestLabel){context.utag_data={_test:bundleData.abTestLabel}}logger.push("Initialize "+(deferred?"a":"")+"synchronous ads "+(docReady?"on document ready ":"")+"with settings:\n",s);gt.cmd.push(initService)},function(err){console.error(err)})};var loadScript=function(){var s=getSettings(),elType="script",scriptSrc,secureProtocol="https:",gads=document.createElement(elType),useSSL=secureProtocol===document.location.protocol,node;if(!!s){scriptSrc=s.script}else{logger.push("!!!ERROR: Unable to get settings!!!")}if(scriptLoaded===true){logger.push("Ad script already loaded!");return}if(!!scriptSrc){scriptSrc=(useSSL?secureProtocol:"http:")+s.script;if(deferred===true){logger.push("Lazy loading ad script");gads.id=scriptId;gads.async=true;gads.type="text/javascript";gads.src=scriptSrc;node=document.getElementsByTagName(elType)[0];node.parentNode.insertBefore(gads,node);scriptLoaded=true}}};var initDeferred=function(){if(false===scriptLoaded){loadScript()}init();if(gtCmdQueue.length>0){for(var i=0;i<gtCmdQueue.length;i++){gt.cmd.push(gtCmdQueue[i])}}};(function(){var s=getSettings();deferred=s.deferred;if(true===hasAdServiceClient()){scriptLoaded=true}gt=context.googletag||{};gt.cmd=gt.cmd||[];if(!!gt.cmd&&!!gt.cmd.length&&gt.cmd.length>0){gtCmdQueue=gt.cmd;gt.cmd=[]}context.googletag=gt;if(deferred===true){var $=context.jQuery;if(!!$){$(doc).ready(function(){docReady=true;initDeferred()})}else{initDeferred()}}else{init()}})();(function($){$.fn.getStyleObject=function(){var dom=this.get(0);var style;var returns={};var prop;if(window.getComputedStyle){var camelize=function(a,b){return b.toUpperCase()};style=window.getComputedStyle(dom,null);if(style){for(var i=0;i<style.length;i++){prop=style[i];var camel=prop.replace(/\-([a-z])/g,camelize);var val=style.getPropertyValue(prop);returns[camel]=val}}return returns}if(dom.currentStyle){style=dom.currentStyle;for(prop in style){if(style.hasOwnProperty(prop)){returns[prop]=style[prop]}}return returns}return this.css()}})(context.jQuery);logger.push("performance","logLoaded")})(this);
var bk_ignore_meta=true;(function(context){"use strict";var doc=context.document,$doc=$(doc);var initBlueKai=function(){if(typeof bk_addPageCtx!="function"){return}var params=$("meta[name=bluekaiParams]").attr("content");if(typeof params=="undefined"||!params){return}params=$.parseJSON(params);if(params){if(typeof params.pageParams!="undefined"){params.pageParams.anon_id=$.cookie("XCLGFbrowser");$(".js-bluekai-debug-values").each(function(i,e){var $this=$(e);var dataStr=$this.text();dataStr=dataStr.replace(/\{anon_id}/g,params.pageParams.anon_id);$this.text(dataStr)});$.each(params.pageParams,function(key,value){if(value){bk_addPageCtx(key,value.toString())}})}if(typeof bk_doJSTag=="function"){bk_doJSTag(params.siteId,4)}}else{return false}};$doc.ready(initBlueKai)})(this,jQuery);
(function(doc){var updateNativeAdSrc=function(){$("img.impression-tracker").each(function(){var src=$(this).attr("data-src").replace("[timestamp]",$.now()).replace("[vguid]",Phoenix.ViewGuid.get());$(this).attr("src",src)})};$(updateNativeAdSrc);$(doc).ajaxComplete(updateNativeAdSrc)})(document);